<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="A post about git bisect, possibly the most satisfying tool to find bugs.">
    <meta name="author" content="Diego Frias">
    <meta name="robots" content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">
    <title>Finding Bugs in log(n) Time With Git Bisect - dzfrias</title>
    <link rel="stylesheet" href="/css/style.css">
    <script type="module" src="/js/index.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0f0f0f">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <meta name="theme-color" content="#0f0f0f">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link rel="preconnect" href="https://fonts.gstatic.com"><link data-href="https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@300..900&display=swap" rel="stylesheet"><style data-href="https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@300..900&display=swap">/* hebrew */
@font-face {
  font-family: 'Frank Ruhl Libre';
  font-style: normal;
  font-weight: 300 900;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/frankruhllibre/v21/j8_w6_fAw7jrcalD7oKYNX0QfAnPW7Ll4brkiY-xBg.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* latin-ext */
@font-face {
  font-family: 'Frank Ruhl Libre';
  font-style: normal;
  font-weight: 300 900;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/frankruhllibre/v21/j8_w6_fAw7jrcalD7oKYNX0QfAnPW77l4brkiY-xBg.woff2) format('woff2');
  unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Frank Ruhl Libre';
  font-style: normal;
  font-weight: 300 900;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/frankruhllibre/v21/j8_w6_fAw7jrcalD7oKYNX0QfAnPW7Dl4brkiY8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
</style>
  </head>
  <body>
    <header>
      <nav>
        <a href="/" aria-label="Home">
          <div class="header-logo">
            <svg class="profile" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_1_2)">
<rect width="200" height="200" fill="#7B7B7B"></rect>
<path d="M-50 -50L245 245L-50 240.719V-50Z" fill="#040404"></path>
<path d="M98.45 34.8C106.25 34.2 110.1 33.9 110 33.9C110.9 33.9 111.5 34.25 111.8 34.95C111.9 35.35 108.3 50.25 101 79.65L89.6 125.25C89.4 127.55 89.4 129.4 89.6 130.8C89.8 131.3 90.1 131.7 90.5 132C90.8 132.3 91.25 132.45 91.85 132.45C92.55 132.45 93.1 132.35 93.5 132.15C95.4 130.75 97.35 126.2 99.35 118.5C99.85 116.6 100.25 115.55 100.55 115.35C100.75 115.15 101.95 115.05 104.15 115.05C106.35 115.05 107.6 115.15 107.9 115.35C108.1 115.55 108.2 115.95 108.2 116.55C108.2 117.15 107.95 118.35 107.45 120.15C103.75 132.75 98.5 139.25 91.7 139.65C86.6 139.95 82.5 138.2 79.4 134.4C78.9 133.8 78.45 133.15 78.05 132.45C77.85 131.85 77.7 131.55 77.6 131.55L76.55 132.45C73.05 135.55 69.6 137.6 66.2 138.6C59.7 140.8 53.85 139.8 48.65 135.6C48.05 135.1 47.5 134.55 47 133.95C45.5 132.45 44.25 130.65 43.25 128.55C40.75 123.45 39.95 117.4 40.85 110.4C42.45 99 47.3 89.4 55.4 81.6C60.6 76.6 66.25 73.45 72.35 72.15C73.25 71.95 74.65 71.85 76.55 71.85C79.05 71.85 81.2 72.25 83 73.05C84.4 73.75 85.7 74.7 86.9 75.9C87.7 76.7 88.1 77 88.1 76.8C88.2 76.7 89.45 71.9 91.85 62.4C94.15 53.1 95.35 47.9 95.45 46.8C95.45 45.9 95.35 45.35 95.15 45.15C94.45 44.45 92.3 44.05 88.7 43.95C86.3 43.95 84.9 43.6 84.5 42.9L84.35 42.45L85.1 39.45C85.5 37.55 85.9 36.4 86.3 36C86.6 35.7 86.9 35.55 87.2 35.55L98.45 34.8ZM77.15 78.9C73.05 78.2 69.1 80.15 65.3 84.75C64.3 86.05 63.4 87.45 62.6 88.95C61.1 91.85 59.3 97.55 57.2 106.05C55.9 110.85 54.95 115.05 54.35 118.65C53.95 122.05 53.95 124.65 54.35 126.45C55.35 129.95 57.3 131.95 60.2 132.45C61.9 132.75 63.95 132.4 66.35 131.4C69.95 129.4 73.35 126.05 76.55 121.35L77.3 120.3L81.05 105.3L84.8 90.3L84.5 89.25C83.6 83.55 81.4 80.15 77.9 79.05C77.7 78.95 77.45 78.9 77.15 78.9ZM154.811 32.4C155.311 32.3 156.311 32.25 157.811 32.25C160.111 32.35 162.211 32.9 164.111 33.9C168.011 35.9 169.961 39.1 169.961 43.5C169.961 45.3 169.561 47 168.761 48.6C168.361 49.6 167.761 50.45 166.961 51.15C165.961 52.15 165.111 52.8 164.411 53.1C161.611 54.4 158.961 54.45 156.461 53.25C153.961 51.95 153.061 49.65 153.761 46.35C153.861 45.95 153.961 45.55 154.061 45.15C154.761 42.85 156.011 41.15 157.811 40.05C158.311 39.75 157.961 39.5 156.761 39.3C156.061 39.3 155.561 39.4 155.261 39.6C154.461 40.2 153.911 40.9 153.611 41.7C153.211 42.5 152.161 47.1 150.461 55.5C148.161 66.5 147.011 72.4 147.011 73.2C147.011 73.3 149.711 73.35 155.111 73.35H163.211L163.811 73.8C164.211 74.3 164.161 75.65 163.661 77.85C163.161 80.05 162.711 81.25 162.311 81.45C162.011 81.65 159.111 81.75 153.611 81.75C148.111 81.75 145.361 81.85 145.361 82.05L141.461 101.85L136.961 125.1C134.261 138.1 131.661 147.4 129.161 153C125.961 160.4 121.861 165.25 116.861 167.55C115.461 168.25 113.961 168.65 112.361 168.75C107.961 168.95 104.461 167.6 101.861 164.7C101.661 164.6 101.511 164.45 101.411 164.25C100.011 162.25 99.3113 160.05 99.3113 157.65C99.3113 155.75 99.7113 154 100.511 152.4C100.911 151.4 101.511 150.55 102.311 149.85C103.311 148.85 104.161 148.2 104.861 147.9C107.661 146.6 110.311 146.55 112.811 147.75C115.311 149.05 116.211 151.35 115.511 154.65C115.411 155.05 115.311 155.45 115.211 155.85C114.511 158.15 113.261 159.85 111.461 160.95C110.861 161.35 111.211 161.55 112.511 161.55C113.311 161.55 113.911 161.4 114.311 161.1C115.611 160.1 116.611 157.5 117.311 153.3C118.311 147 119.811 139.9 121.811 132L124.811 118.5C129.511 93.4 131.861 81.2 131.861 81.9C131.861 81.8 129.561 81.75 124.961 81.75C120.061 81.75 117.411 81.4 117.011 80.7C116.811 80.4 116.961 79.25 117.461 77.25C117.961 75.25 118.361 74.1 118.661 73.8L119.111 73.35H126.311H133.511V73.05L135.011 65.7C137.011 55.3 138.961 48.05 140.861 43.95C143.961 37.65 148.611 33.8 154.811 32.4Z" fill="white"></path>
</g>
<defs>
<clipPath id="clip0_1_2">
<rect width="200" height="200" fill="white"></rect>
</clipPath>
</defs>
</svg>

          </div>
        </a>
        <ul>
          
          <li>
            <a href="/blog/">Blog</a>
          </li>
          
          <li>
            <a href="/projects/">Projects</a>
          </li>
          
          <li>
            <a href="https://github.com/dzfrias">GitHub</a>
          </li>
          
        </ul>
      </nav>
    </header>
    <main tabindex="-1">
      <div id="main-left">
        
<nav class="toc">
        <ol><li><a href="#what-is-git-bisect%3F">What is Git Bisect?</a><ol><li><a href="#summary">Summary</a></li></ol></li><li><a href="#usage">Usage</a></li><li><a href="#wrap-up">Wrap-Up</a></li></ol>
      </nav>

      </div>
      <div id="main-content" style="margin-top: 1rem; width: var(--width)">
        <div style="width: min(95%, 65ch)">
          
<h1>Finding Bugs in log(n) Time With Git Bisect</h1>
<p>You begin running your application, just for fun. It's gotten pretty large at
this point, complete with <strong>dozens</strong> of features and interesting interactions.
You decide to test one of them. An old favorite, perhaps? You trigger it,
expecting to see a pleasant popup that you spent a weekend on a few months back.</p>
<p>Your application stutters, stops, and crashes.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> You do a double take.
You try again. Same result. The expectations, the disappointment, the casual
naivety you started with, the irony of it all: <em>it's shocking</em>, like stepping
down to a nonexistent stair in the dark.</p>
<p>You've found a
<a href="https://en.wikipedia.org/wiki/Software_regression"><strong>regression</strong></a>: a bug that
breaks a that feature previously worked. In large codebases with long, storied
git histories, they can be <em>notoriously</em> difficult to track down. In this post,
I'll show you an effective way to find the <strong>exact commit</strong> which introduced the
bug, in the order of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>log</mi><mn>2</mn></msub><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\log_2(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span> time.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup></p>
<h2 id="what-is-git-bisect%3F" tabindex="-1"><a class="header-anchor" href="#what-is-git-bisect%3F">What is Git Bisect?</a></h2>
<blockquote>
<p>Note: This section assumes you have some knowledge of
<a href="https://git-scm.com/">git</a>.</p>
</blockquote>
<p>I will introduce <code>git bisect</code> with an example: our goal is to find the <strong>first
version</strong> of the app that introduces the bug, in a history that looks like this:</p>
<p></p><div class="expand-img"><button aria-haspopup="dialog" aria-label="Expand image"><picture><source type="image/webp" srcset="/img/K0kpCeqXBt-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/K0kpCeqXBt-1794.jpeg" alt="Commit history (7 commits)" width="1794" height="211"></picture></button><dialog><picture><source type="image/webp" srcset="/img/K0kpCeqXBt-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/K0kpCeqXBt-1794.jpeg" alt="Commit history (7 commits)" width="1794" height="211"></picture></dialog></div><p></p>
<p>Each circle represents a version of your app (i.e. a commit), where the bug may
or may not be hiding. <code>G</code> represents your current version, which you know is
broken. Your first instinct <em>might</em> be to check if commit <code>D</code> has the bug, since
it's in the middle of the &quot;timeline&quot;:</p>
<p></p><div class="expand-img"><button aria-haspopup="dialog" aria-label="Expand image"><picture><source type="image/webp" srcset="/img/kpGP1OEevM-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/kpGP1OEevM-1794.jpeg" alt="Checking out commit D" width="1794" height="211"></picture></button><dialog><picture><source type="image/webp" srcset="/img/kpGP1OEevM-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/kpGP1OEevM-1794.jpeg" alt="Checking out commit D" width="1794" height="211"></picture></dialog></div><p></p>
<p>It does! Importantly, we can make an assertion with this information: <strong>anything
to the right of commit <code>D</code> must also have the bug</strong>, since git commits are
chronologically ordered (<code>G</code> is your most recent version).<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup> So, really,
your history looks like this:</p>
<p></p><div class="expand-img"><button aria-haspopup="dialog" aria-label="Expand image"><picture><source type="image/webp" srcset="/img/HiPOghetJ1-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/HiPOghetJ1-1794.jpeg" alt="Decreasing the search space" width="1794" height="211"></picture></button><dialog><picture><source type="image/webp" srcset="/img/HiPOghetJ1-1794.webp 1794w"><img loading="lazy" decoding="async" src="/img/HiPOghetJ1-1794.jpeg" alt="Decreasing the search space" width="1794" height="211"></picture></dialog></div><p></p>
<p>Your search space has now decreased by half. You now check if <code>B</code> has the bug,
since it lies in the middle of the three unknown commits.</p>
<p></p><div class="expand-img"><button aria-haspopup="dialog" aria-label="Expand image"><picture><source type="image/webp" srcset="/img/MQ9kDJc-qs-1793.webp 1793w"><img loading="lazy" decoding="async" src="/img/MQ9kDJc-qs-1793.jpeg" alt="Checking out commit B" width="1793" height="211"></picture></button><dialog><picture><source type="image/webp" srcset="/img/MQ9kDJc-qs-1793.webp 1793w"><img loading="lazy" decoding="async" src="/img/MQ9kDJc-qs-1793.jpeg" alt="Checking out commit B" width="1793" height="211"></picture></dialog></div><p></p>
<p><code>B</code> doesn't have the bug, so <code>A</code> must not either! That means that there are two
options now:</p>
<ol>
<li><code>C</code> is green: bug in <code>D</code>!</li>
<li><code>C</code> is red: bug in <code>C</code>!</li>
</ol>
<p>You check <code>C</code>, and it's green:</p>
<p></p><div class="expand-img"><button aria-haspopup="dialog" aria-label="Expand image"><picture><source type="image/webp" srcset="/img/rk-QUUvlhi-1793.webp 1793w"><img loading="lazy" decoding="async" src="/img/rk-QUUvlhi-1793.jpeg" alt="Checking out commit C" width="1793" height="211"></picture></button><dialog><picture><source type="image/webp" srcset="/img/rk-QUUvlhi-1793.webp 1793w"><img loading="lazy" decoding="async" src="/img/rk-QUUvlhi-1793.jpeg" alt="Checking out commit C" width="1793" height="211"></picture></dialog></div><p></p>
<p>So, you must've introduced the bug in <code>D</code>, meaning that you know <em>exactly</em> where
to look to make a fix!</p>
<h3 id="summary" tabindex="-1"><a class="header-anchor" href="#summary">Summary</a></h3>
<p>If you're familiar with algorithms, this process is basically a
<a href="https://en.wikipedia.org/wiki/Binary_search">binary search</a>. <code>git bisect</code> is a
handy sub-command built into git that <em>automates</em> what I just showed. Yes, you
<em>could</em> get the exact middle of your git history yourself, but <code>git bisect</code> will
do it for you! In the next section, I'll go over how to use the command.</p>
<h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage">Usage</a></h2>
<p>To start <code>git bisect</code>, run</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> bisect start</code></pre>
<p>This will give you a message that looks like this:</p>
<pre class="language-text"><code class="language-text">status: waiting for both good and bad commits</code></pre>
<p><code>git bisect</code> needs to know at least one commit that is &quot;good&quot; (no bug), and one
commit that is &quot;bad&quot; (has bug). <code>git bisect</code> will find the first &quot;bad&quot; commit,
as shown in <a href="#what-is-git-bisect%3F">the example</a>.</p>
<p>Usually, the commit I'm currently on (<code>HEAD</code>) is bad, and we can let <code>git</code> know
like so:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> bisect bad
status: waiting <span class="token keyword">for</span> good commit<span class="token punctuation">(</span>s<span class="token punctuation">)</span>, bad commit known</code></pre>
<p><code>git bisect</code> is telling us now that it only needs to know <strong>any</strong> commit that is
good. You can find this manually by checking out some old commit and seeing if
it has the bug, or you can just tell <code>git</code> that your very first commit is good
(as is often the case):</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> bisect good <span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> rev-list <span class="token parameter variable">--oneline</span> HEAD <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-wf1</span><span class="token variable">)</span></span></code></pre>
<p>After entering this, you'll be automatically switched to a version of your
repository. From there, you can run your app and see if it has the bug. If it
does, run <code>git bisect bad</code>. If it doesn't, run <code>git bisect good</code>. In other
words, you have the following workflow:</p>
<ol>
<li>Check out a commit</li>
<li>Good or bad</li>
<li>Repeat until <code>git</code> finds the first bad commit!</li>
</ol>
<blockquote>
<p>Note: If at any point you need to quit the bisection, run <code>git bisect reset</code>.</p>
</blockquote>
<h2 id="wrap-up" tabindex="-1"><a class="header-anchor" href="#wrap-up">Wrap-Up</a></h2>
<p>This post went over how <code>git bisect</code> can be used to fix regressions! I also
showed it actually works, using <a href="#what-is-git-bisect%3F">an example</a>. I
personally use the sub-command quite often, especially as my projects grow older
and more complex.</p>
<p>If you want to learn more about <code>git bisect</code>, you can
<a href="https://git-scm.com/docs/git-bisect">read the manual</a>! If you have any
feedback, questions, or issues with this post, feel free to
<a href="https://github.com/dzfrias/website/issues/new">submit an issue</a> on this
website's GitHub repository!</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Maybe it even gives you a really helpful crash message such as: <code>SIGBUS</code>. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>That is, if you have 1000 commits, you'll find it in 10 steps worst-case. <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p>If you need some time to wrap your head around this, feel free to! This also
makes the assumption that the bug isn't introduced, fixed, then
<em>reintroduced</em> in the timeline. <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>


        </div>
      </div>
      <div id="main-right">
        
        
      </div>
    </main>
  </body>
</html>
